{% extends 'base.html' %}
{% block title %}{{ super() }}
{{ question['title'][:50] + ('...' if question['title']|length > 50 else '') }}
{% endblock %}

{% block body %}

<h2>{{ question['title'] }}</h2>

{% if question['body'] %}
    <p>{{ question['body'] }}</p>
{% endif %}

{% if question['image_url'] %}
    <img src="{{ question['image_url'] }}" alt="Illustration"><br>
{% endif %}

{% for tag in question.get('tags') %}

    #{{ tag['name'] }}
    <a href="/question/{{ question['id'] }}/tag/{{ tag['id'] }}/delete">‚ùå</a>

{% endfor %}<br>

<small>Submitted: {{ question['created'] }} Views: {{ question['view_count'] }} Votes: {{ question['vote_count'] }}</small><br>

<form action="add-tag">
    <input type="submit" value="Add tag" />
</form>

<form action="vote-up" method="POST">
    <input type="submit" value="Vote up" />
</form>

<form action="vote-down" method="POST">
    <input type="submit" value="Vote down" />
</form>

<form action="edit">
    <input type="submit" value="Edit" />
</form>

<form action="delete">
    <input type="submit" value="Delete" />
</form>

{% if question['comments'] %}
    <h4>Comments:</h4>
    {% for comment in question['comments'] %}
        <p>{{ comment['body'] }}<br>
            <small>Submitted: {{ comment['created'] }}</small>
        </p>

        <form action="/comment/{{ comment['id'] }}/edit">
            <input type="submit" value="Edit" />
        </form>

        <form action="/comment/{{ comment['id'] }}/delete">
            <input type="submit" value="Delete" />
        </form>
    {% endfor %}
{% endif %}

<small><a href="add-comment">Add comment</a></small>

{% if question.get('answers') %}
    <h3>Answers:</h3>

    {% for answer in question.get('answers') %}
        <p>{{ answer['body'] }}</p>
        <small>Submitted: {{ answer['created'] }} Votes: {{ answer['vote_count'] }}</small><br>
        {% if answer['image_url'] %}
            <img src="{{ answer['image_url'] }}" alt="Illustration"><br>
        {% endif %}

        <form action="/answer/{{ answer['id'] }}/vote-up" method="POST">
            <input type="submit" value="Vote up" />
        </form>

        <form action="/answer/{{ answer['id'] }}/vote-down" method="POST">
            <input type="submit" value="Vote down" />
        </form>

        <form action="/answer/{{ answer['id'] }}/edit">
            <input type="submit" value="Edit" />
        </form>

        <form action="/answer/{{ answer['id'] }}/delete">
            <input type="submit" value="Delete" />
        </form>

        {% if answer['comments'] %}
            <h4>Comments:</h4>
            {% for comment in answer['comments'] %}
                <p>{{ comment['body'] }}<br>
                    <small>Submitted: {{ comment['created'] }}</small>
                </p>

                <form action="/comment/{{ comment['id'] }}/edit">
                    <input type="submit" value="Edit" />
                </form>

                <form action="/comment/{{ comment['id'] }}/delete">
                    <input type="submit" value="Delete" />
                </form>
            {% endfor %}

        {% endif %}
        <small><a href="/answer/{{ answer['id'] }}/add-comment">Add comment</a></small>

    {% endfor %}

    <h3>Add your answer:</h3>

{% else %}

    <h3>Be the first to answer this question:</h3>

{% endif %}

    <form action="submit-answer" method="post">

        <label for="details">Your answer:</label><br>
        <textarea id="details" name="body" minlength="10" required></textarea><br>

        <label for="image">Image URL:</label><br>
        <input id="image" type="text" name="image_url" min placeholder="e.g. http://www.images.com/cutekitten.jpg"><br>

        <input type="submit">

    </form>

{% endblock %}
